<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档 - MCDR MCP Service</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#8b5cf6',
                        accent: '#06b6d4',
                        dark: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a'
                        }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-dark-900 text-gray-100" x-data="docsApp()">
    <!-- 导航栏 -->
    <nav class="fixed top-0 w-full z-50 transition-all duration-300" 
         :class="isScrolled ? 'navbar-scroll' : 'bg-transparent'"
         x-data="{ isMenuOpen: false, isScrolled: false }"
         x-init="window.addEventListener('scroll', () => isScrolled = window.scrollY > 50)">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-cube text-primary text-2xl mr-3"></i>
                    <span class="text-xl font-bold">MCDR MCP Service</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-gray-300 hover:text-primary transition-colors">首页</a>
                    <a href="install.html" class="nav-link text-gray-300 hover:text-primary transition-colors">安装配置</a>
                    <a href="docs.html" class="nav-link text-primary">文档</a>
                    <a href="https://github.com/LoosePrince/mcdr_mcp_service" target="_blank" class="nav-link text-gray-300 hover:text-primary transition-colors"><i class="fab fa-github mr-1"></i>GitHub</a>
                </div>
                <button @click="isMenuOpen = !isMenuOpen" class="md:hidden text-gray-300 hover:text-primary">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <!-- 移动端菜单 -->
        <div x-show="isMenuOpen" class="md:hidden bg-dark-800 border-t border-dark-700">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="index.html" class="block px-3 py-2 text-gray-300 hover:text-primary">首页</a>
                <a href="install.html" class="block px-3 py-2 text-gray-300 hover:text-primary">安装配置</a>
                <a href="docs.html" class="block px-3 py-2 text-primary">文档</a>
                <a href="https://github.com/LoosePrince/mcdr_mcp_service" target="_blank" class="block px-3 py-2 text-gray-300 hover:text-primary"><i class="fab fa-github mr-1"></i>GitHub</a>
            </div>
        </div>
    </nav>

    <!-- 英雄区域 -->
    <section class="pt-24 pb-16 bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-6">
                <span class="gradient-text bg-clip-text text-transparent">API 文档</span>
            </h1>
            <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                完整的 API 参考和使用指南，帮助您充分利用 MCDR MCP Service 的所有功能
            </p>
            
            <!-- 搜索框 -->
            <div class="mt-8 max-w-md mx-auto">
                <div class="relative">
                    <input type="text" 
                           placeholder="搜索文档..." 
                           class="w-full bg-dark-800 border border-gray-600 rounded-lg px-4 py-3 pl-10 focus:outline-none focus:border-primary"
                           x-model="searchQuery"
                           @input="search()">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- 文档内容 -->
    <section class="py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid lg:grid-cols-4 gap-8">
                <!-- 侧边栏导航 -->
                <div class="lg:col-span-1">
                    <div class="sticky top-24">
                        <h3 class="text-lg font-semibold mb-4">目录</h3>
                        <nav class="space-y-2">
                            <a href="#getting-started" class="block px-3 py-2 text-gray-400 hover:text-primary transition-colors">快速开始</a>
                            <a href="#mcp-services" class="block px-3 py-2 text-gray-400 hover:text-primary transition-colors">MCP 服务</a>
                            <a href="#configuration" class="block px-3 py-2 text-gray-400 hover:text-primary transition-colors">配置选项</a>
                            <a href="#troubleshooting" class="block px-3 py-2 text-gray-400 hover:text-primary transition-colors">故障排除</a>
                        </nav>
                    </div>
                </div>

                <!-- 主要内容 -->
                <div class="lg:col-span-3">
                    <!-- 快速开始 -->
                    <section id="getting-started" class="mb-12">
                        <h2 class="text-3xl font-bold mb-6">快速开始</h2>
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4">基本使用流程</h3>
                            <ol class="list-decimal list-inside space-y-2 text-gray-300">
                                <li>安装并配置 MCDR MCP Service 插件</li>
                                <li>启动 MCP 服务器</li>
                                <li>使用 MCP 客户端连接到服务器</li>
                                <li>开始发送命令和接收服务器状态</li>
                            </ol>
                        </div>
                    </section>

                    <!-- MCP 服务 -->
                    <section id="mcp-services" class="mb-12">
                        <h2 class="text-3xl font-bold mb-6">MCP 服务</h2>
                        <p class="text-lg text-gray-400 mb-8">MCP 服务为 AI 和自动化工具提供标准化接口，支持命令执行、状态查询、日志管理等多种能力。以下为主要服务说明：</p>

                        <!-- get_command_tree -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">get_command_tree</h3>
                            <p class="text-gray-400 mb-2">获取 MCDR 可用命令列表和指令树</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>plugin_id</code> (可选): 指定插件ID</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "get_command_tree",
  "arguments": {}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- execute_command -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">execute_command</h3>
                            <p class="text-gray-400 mb-2">执行 MCDR 或 Minecraft 服务器命令，并捕获响应</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>command</code> (必需): 要执行的命令</li>
                                    <li><code>source_type</code> (可选): 命令来源类型（console/player）</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "execute_command",
  "arguments": {
    "command": "!!MCDR status"
  }
}</code></pre></div>
                            </div>
                        </div>

                        <!-- get_server_status -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">get_server_status</h3>
                            <p class="text-gray-400 mb-2">获取 MCDR 服务器状态信息</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>include_players</code> (可选): 是否包含在线玩家信息</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "get_server_status",
  "arguments": {}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- get_recent_logs -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">get_recent_logs</h3>
                            <p class="text-gray-400 mb-2">获取最近的服务器日志</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>lines_count</code> (可选): 获取的日志行数</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "get_recent_logs",
  "arguments": {"lines_count": 20}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- get_logs_range -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">get_logs_range</h3>
                            <p class="text-gray-400 mb-2">获取指定范围的服务器日志</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>start_line</code> (可选): 起始行号</li>
                                    <li><code>end_line</code> (必需): 结束行号</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "get_logs_range",
  "arguments": {"start_line": 100, "end_line": 150}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- search_logs -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">search_logs</h3>
                            <p class="text-gray-400 mb-2">搜索日志内容，支持文本和正则表达式</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>query</code> (必需): 搜索内容</li>
                                    <li><code>use_regex</code> (可选): 是否使用正则</li>
                                    <li><code>context_lines</code> (可选): 上下文行数</li>
                                    <li><code>max_results</code> (可选): 最大返回数</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "search_logs",
  "arguments": {"query": "玩家登录", "context_lines": 2}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- search_logs_by_ids -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">search_logs_by_ids</h3>
                            <p class="text-gray-400 mb-2">根据搜索ID范围查询日志</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">参数</h4>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li><code>start_id</code> (必需): 起始搜索ID</li>
                                    <li><code>end_id</code> (必需): 结束搜索ID</li>
                                    <li><code>context_lines</code> (可选): 上下文行数</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">请求示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "search_logs_by_ids",
  "arguments": {"start_id": 1200, "end_id": 1250, "context_lines": 1}
}</code></pre></div>
                            </div>
                        </div>

                        <!-- MCDR自带命令工具 -->
                        <div class="bg-dark-800 rounded-lg p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4 text-primary">MCDR 自带命令工具</h3>
                            <p class="text-gray-400 mb-2">将 MCDR 自带命令（如 <code>!!MCDR status</code>）自动映射为独立工具，便于 AI 直接调用。</p>
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">调用示例</h4>
                                <div class="code-block"><pre><code>{
  "name": "mcdr_status",
  "arguments": {}
}</code></pre></div>
                            </div>
                        </div>
                    </section>

                    <!-- 配置选项 -->
                    <section id="configuration" class="mb-12">
                        <h2 class="text-3xl font-bold mb-6">配置选项</h2>
                        
                        <div class="bg-dark-800 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">配置文件结构</h3>
                            <div class="code-block">
                                <pre><code>{
  "mcp_server": {
    "host": "localhost",           // MCP 服务器监听地址
    "port": 8080,                  // MCP 服务器端口
    "enabled": true,               // 是否启用 MCP 服务
    "max_connections": 10,         // 最大连接数
    "timeout": 30                  // 超时时间（秒）
  },
  
  "security": {
    "api_key": "your-secret-key",  // API 访问密钥
    "allowed_commands": [          // 允许执行的命令列表
      "list",
      "help",
      "status"
    ],
    "blocked_commands": [          // 禁止执行的命令列表
      "stop",
      "restart"
    ],
    "rate_limit": 100              // 每分钟请求限制
  },
  
  "logging": {
    "level": "INFO",               // 日志级别
    "file": "logs/mcp_service.log", // 日志文件路径
    "max_size": "10MB",            // 单个日志文件最大大小
    "backup_count": 5              // 保留的日志文件数量
  },
  
  "monitoring": {
    "update_interval": 5,          // 状态更新间隔（秒）
    "metrics_enabled": true,       // 是否启用性能监控
    "alerts_enabled": true         // 是否启用告警
  }
}</code></pre>
                            </div>
                        </div>
                    </section>

                    <!-- 故障排除 -->
                    <section id="troubleshooting" class="mb-12">
                        <h2 class="text-3xl font-bold mb-6">故障排除</h2>
                        
                        <div class="space-y-6">
                            <div class="bg-dark-800 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-2 text-red-400">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                    连接被拒绝
                                </h3>
                                <p class="text-gray-400 mb-2">错误信息：Connection refused</p>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li>1. 检查 MCP 服务是否已启动</li>
                                    <li>2. 确认端口配置正确</li>
                                    <li>3. 检查防火墙设置</li>
                                </ul>
                            </div>
                            
                            <div class="bg-dark-800 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-2 text-yellow-400">
                                    <i class="fas fa-key mr-2"></i>
                                    认证失败
                                </h3>
                                <p class="text-gray-400 mb-2">错误信息：401 Unauthorized</p>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li>1. 检查 API 密钥是否正确</li>
                                    <li>2. 确认密钥格式正确</li>
                                    <li>3. 检查 Authorization 头格式</li>
                                </ul>
                            </div>
                            
                            <div class="bg-dark-800 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-2 text-blue-400">
                                    <i class="fas fa-clock mr-2"></i>
                                    命令超时
                                </h3>
                                <p class="text-gray-400 mb-2">错误信息：Command timeout</p>
                                <ul class="text-sm text-gray-500 space-y-1">
                                    <li>1. 增加 timeout 参数值</li>
                                    <li>2. 检查服务器性能</li>
                                    <li>3. 避免执行耗时过长的命令</li>
                                </ul>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-dark-900 border-t border-dark-700 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <i class="fas fa-cube text-primary text-2xl mr-3"></i>
                        <span class="text-xl font-bold">MCDR MCP Service</span>
                    </div>
                    <p class="text-gray-400">为MCDReforged提供AI驱动的服务器管理解决方案</p>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-4">快速链接</h4>
                    <div class="space-y-2">
                        <a href="index.html" class="block text-gray-400 hover:text-primary transition-colors">首页</a>
                        <a href="install.html" class="block text-gray-400 hover:text-primary transition-colors">安装配置</a>
                        <a href="docs.html" class="block text-gray-400 hover:text-primary transition-colors">文档</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-4">社区</h4>
                    <div class="space-y-2">
                        <a href="https://github.com/LoosePrince/mcdr_mcp_service" target="_blank" class="block text-gray-400 hover:text-primary transition-colors">
                            <i class="fab fa-github mr-2"></i>GitHub
                        </a>
                        <a href="docs.html" class="block text-gray-400 hover:text-primary transition-colors">
                            <i class="fas fa-book mr-2"></i>文档
                        </a>
                        <a href="https://github.com/LoosePrince/mcdr_mcp_service/issues" class="block text-gray-400 hover:text-primary transition-colors">
                            <i class="fas fa-question-circle mr-2"></i>支持
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-dark-700 mt-8 pt-8 text-center">
                <p class="text-gray-400">&copy; 2025 MCDR MCP Service. 使用 MIT 许可证开源</p>
                <p class="text-sm text-gray-500 mt-2">⚠️ 本插件目前仅为测试版本，请谨慎使用</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        // 文档页面特定的 JavaScript
        function docsApp() {
            return {
                searchQuery: '',
                search() {
                    const query = this.searchQuery.trim().toLowerCase();
                    // 只搜索主要内容区的文档卡片
                    const cards = document.querySelectorAll('.lg\\:col-span-3 .bg-dark-800');
                    // 先移除所有高亮
                    cards.forEach(card => {
                        removeHighlights(card);
                    });
                    if (query === '') {
                        cards.forEach(card => {
                            card.style.display = 'block';
                        });
                        return;
                    }
                    cards.forEach(card => {
                        const text = card.textContent.toLowerCase();
                        if (text.includes(query)) {
                            card.style.display = 'block';
                            highlight(card, query);
                        } else {
                            card.style.display = 'none';
                        }
                    });
                }
            }
        }
        // 高亮函数
        function highlight(element, keyword) {
            if (!keyword) return;
            const walk = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false);
            let node;
            const nodes = [];
            while (node = walk.nextNode()) {
                if (node.parentNode && node.nodeValue.toLowerCase().includes(keyword)) {
                    nodes.push(node);
                }
            }
            nodes.forEach(textNode => {
                const val = textNode.nodeValue;
                const reg = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                const temp = document.createElement('span');
                temp.innerHTML = val.replace(reg, '<mark>$1</mark>');
                while (temp.firstChild) {
                    textNode.parentNode.insertBefore(temp.firstChild, textNode);
                }
                textNode.parentNode.removeChild(textNode);
            });
        }
        // 移除高亮
        function removeHighlights(element) {
            const marks = element.querySelectorAll('mark');
            marks.forEach(mark => {
                const parent = mark.parentNode;
                parent.replaceChild(document.createTextNode(mark.textContent), mark);
                parent.normalize();
            });
        }

        // 平滑滚动到锚点
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // 高亮当前目录项
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('text-primary');
                link.classList.add('text-gray-400');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.remove('text-gray-400');
                    link.classList.add('text-primary');
                }
            });
        });
    </script>
</body>
</html>